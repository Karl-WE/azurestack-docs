<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.103.1" />
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/csm-docs/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/csm-docs/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/csm-docs/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/csm-docs/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/csm-docs/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/csm-docs/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/csm-docs/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/csm-docs/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/csm-docs/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/csm-docs/favicons/android-192x192.png" sizes="192x192">

<title>Tools | Dell Technologies</title>
<meta name="description" content="repctl tool for Replication feature in detail
">
<meta property="og:title" content="Tools" />
<meta property="og:description" content="repctl tool for Replication feature in detail
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dell.github.io/csm-docs/v2/replication/tools/" /><meta property="article:section" content="v2" />

<meta property="article:modified_time" content="2022-05-24T16:59:37-03:00" /><meta property="og:site_name" content="Dell Technologies" />

<meta itemprop="name" content="Tools">
<meta itemprop="description" content="repctl tool for Replication feature in detail
">
<meta itemprop="dateModified" content="2022-05-24T16:59:37-03:00" />
<meta itemprop="wordCount" content="966">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tools"/>
<meta name="twitter:description" content="repctl tool for Replication feature in detail
"/>




<link rel="preload" href="/csm-docs/scss/main.min.d0bfa16d819c9dab58324fe79e0fe1241c505038028e706c280c6fb590220afe.css" as="style">
<link href="/csm-docs/scss/main.min.d0bfa16d819c9dab58324fe79e0fe1241c505038028e706c280c6fb590220afe.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/css/prism.css"/>

  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/csm-docs/">
		<span class="navbar-logo"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1017 132"><defs><style>.cls-1{fill:#fff}</style></defs><title>DellTech_Logo_Prm_Wht_rgb</title><path class="cls-1" d="M1015 84.89c0-12.23-6.8-17.66-20.39-20.38s-21.73-4.08-21.73-13.58c0-6.8 5.44-10.87 15-10.87 12.22.0 16.3 5.43 16.3 12.22l1.36 1.36h5.43l1.37-1.36c0-13.58-10.88-19-24.46-19-15 0-23.1 8.15-23.1 17.67.0 10.86 8.15 16.3 21.73 19s20.38 4.08 20.38 15c0 6.79-4.07 12.23-17.66 12.23-12.22.0-17.66-6.8-17.66-15l-1.35-1.36h-5.44l-1.35 1.36c0 12.23 9.5 21.74 25.8 21.74 17.66.0 25.82-8.15 25.82-19M956.58 71.31l1.36-1.37V65.87c0-19-10.87-32.61-29.89-32.61s-29.89 13.59-29.89 32.61v2.72c0 19 9.51 35.32 31.25 35.32 19 0 25.81-12.23 27.17-20.38l-1.36-1.36h-5.43l-1.36 1.36c-2.72 8.15-8.16 13.59-19 13.59-17.66.0-23.1-16.31-23.1-24.46l1.36-1.35zm-8.15-6.8H907.67l-1.36-1.36c0-9.51 5.44-23.09 21.74-23.09s21.74 13.58 21.74 23.09zm-59.78 36.68V36l-1.36-1.35h-5.43L880.5 36v65.22l1.36 1.36h5.43zm0-78.8V14.24l-1.36-1.36h-5.43l-1.36 1.36v8.15l1.36 1.36h5.43zM837 97.12c-13.59.0-21.74-9.52-21.74-28.53S823.44 40.06 837 40.06s21.73 9.5 21.73 28.53S850.61 97.12 837 97.12M858.76 93c0 17.66-4.07 31.25-20.38 31.25-12.22.0-16.3-5.44-17.66-12.23l-1.35-1.36h-5.44l-1.36 1.36c1.36 10.87 9.51 19 25.81 19 17.67.0 28.53-10.87 28.53-38V36l-1.35-1.35h-4.08L860.12 36l-1.36 8.16H857.4c-2.71-5.43-9.5-10.87-21.74-10.87-19 0-28.53 15-28.53 35.33s9.52 35.32 28.53 35.32c12.24.0 19-5.43 21.74-10.87zm-88.3-53c13.58.0 23.09 10.87 23.09 28.53S784 97.12 770.46 97.12s-23.1-10.87-23.1-28.53 9.51-28.53 23.1-28.53m0 63.85c17.66.0 31.25-12.23 31.25-35.32s-13.59-35.33-31.25-35.33-31.25 12.23-31.25 35.33 13.59 35.32 31.25 35.32m-40.76-2.72V8.81l-1.36-1.36h-5.43l-1.36 1.36v92.38l1.36 1.36h5.43zM680.8 40.06c13.58.0 23.09 10.87 23.09 28.53s-9.51 28.53-23.09 28.53-23.1-10.87-23.1-28.53 9.51-28.53 23.1-28.53m0 63.85c17.66.0 31.25-12.23 31.25-35.32S698.46 33.26 680.8 33.26s-31.25 12.23-31.25 35.33 13.59 35.32 31.25 35.32m-39.4-2.72V60.43c0-17.66-9.51-27.17-24.45-27.17-9.52.0-17.67 4.08-21.74 10.87h-1.36L592.49 36l-1.36-1.35h-4.08L585.7 36v65.22l1.35 1.36h5.44l1.36-1.36V64.51c0-15 6.79-24.45 21.73-24.45 10.87.0 17.66 6.79 17.66 20.37v40.76l1.37 1.36H640zm-69.29.0V60.43c0-17.66-9.51-27.17-24.45-27.17-9.52.0-17.66 4.08-21.74 10.87h-1.36V8.81L523.2 7.45h-5.43l-1.36 1.36v92.38l1.36 1.36h5.43l1.36-1.36V64.51c0-15 6.8-24.45 21.74-24.45 10.87.0 17.66 6.79 17.66 20.37v40.76l1.36 1.36h5.44zM455.28 68.59c0-19 9.5-28.53 23.09-28.53s19 8.15 20.38 16.29l1.35 1.37h5.44l1.36-1.37c-1.36-13.58-12.23-23.09-28.53-23.09-17.66.0-31.24 10.87-31.24 35.33s13.58 35.32 31.24 35.32c16.3.0 27.17-9.51 28.53-23.1l-1.36-1.36H500.1l-1.35 1.36C497.39 89 492 97.12 478.37 97.12s-23.09-9.52-23.09-28.53m-14.95 2.72 1.36-1.37V65.87c0-19-10.87-32.61-29.9-32.61s-29.88 13.59-29.88 32.61v2.72c0 19 9.51 35.32 31.25 35.32 19 0 25.81-12.23 27.17-20.38L439 82.17h-5.43l-1.36 1.36c-2.72 8.15-8.15 13.59-19 13.59-17.66.0-23.1-16.31-23.1-24.46l1.36-1.35zm-8.15-6.8H391.42l-1.36-1.36c0-9.51 5.44-23.09 21.73-23.09s21.75 13.58 21.75 23.09zM395.57 12.88V8.81l-1.36-1.36H323.56L322.2 8.81v4.07l1.36 1.36h29.89l1.36 1.36v85.59l1.36 1.36h5.43l1.36-1.36V15.6l1.36-1.36h29.89z"/><path class="cls-1" d="M322.2 83.65v18.9H260.85V7.45h21.6v76.2zM38.55 102.55A47.57 47.57.0 0084.58 67l53.8 42 53.77-42v35.56H253.5V83.65H213.75V7.45h-21.6V43L140.58 83.3l-11.54-9L153.73 55l26.89-21-15.35-12-51.58 40.3-11.53-9L153.73 13 138.38 1 84.58 43a47.57 47.57.0 00-46-35.58H0v95.1zM21.6 83.65V26.35H38.55c14.33.0 26 12.83 26 28.65s-11.67 28.65-26 28.65z"/></svg></span><span class="font-weight-bold">Dell Technologies</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/csm-docs/docs/" ><span>Dell Technologies (Dell) Container Storage Modules (CSM)</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/dell/csm" target="_blank" ><span>GitHub</span></a>
			</li>
			
			
			<li class="nav-item dropdown mr-4 d-none d-lg-block">
				<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Releases
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	
	
	<a class="dropdown-item" href="https://dell.github.io/csm-docs/docs/">Current(v1.3)</a>
	
	<a class="dropdown-item" href="https://dell.github.io/csm-docs/v1">v1.2.1</a>
	
	<a class="dropdown-item" href="https://dell.github.io/csm-docs/v2">v1.2</a>
	
	<a class="dropdown-item" href="https://dell.github.io/csm-docs/v3">v1.1</a>
	
</div>

			</li>
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"><input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/csm-docs/offline-search-index.1e79a0908736ce645e100ec566b3c5a3.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>
</div>
</nav>

    </header>
    <div class="container-fluid td-default td-outer">
      <main role="main" class="td-main">
        

<h1 id="repctl">repctl</h1>
<p><code>repctl</code> is a command-line client for configuring replication 
and managing replicated resources between multiple Kubernetes clusters.</p>
<h2 id="usage">Usage</h2>
<h3 id="managing-clusters">Managing Clusters</h3>
<p>To begin managing replication with <code>repctl</code> you need to add your Kubernetes
clusters, you can do that using <code>cluster add</code> command</p>
<pre><code class="language-shell">./repctl cluster add -f &lt;config-file&gt; -n &lt;name&gt;
</code></pre>
<p>You can view clusters that are currently being managed by <code>repctl</code>
by running <code>cluster get</code> command</p>
<pre><code class="language-shell">./repctl cluster get
</code></pre>
<p>Or, alternatively, using <code>get cluster</code> command</p>
<pre><code class="language-shell">./repctl get cluster
</code></pre>
<p>Also, you can inject information about all of your current clusters as
config maps into the same clusters, so it can be used by <code>dell-csi-replicator</code></p>
<pre><code class="language-shell">./repctl cluster inject
</code></pre>
<p>You can also generate kubeconfigs from existing replication service accounts and inject them in config maps by providing <code>--use-sa</code> flag</p>
<pre><code class="language-shell">./repctl cluster inject --use-sa
</code></pre>
<h3 id="querying-resources">Querying Resources</h3>
<p>After adding clusters you want to manage with <code>repctl</code> you can query
resources from multiple clusters at once using <code>get</code> command.</p>
<p>For example, this command will list all storage classes in all clusters
that currently are being managed by <code>repctl</code></p>
<pre><code class="language-shell">./repctl get storageclasses --all
</code></pre>
<p>If you want to query some particular clusters you can do that by specifying
<code>clusters</code> flag</p>
<pre><code class="language-shell">./repctl get pv --clusters cluster-1,cluster-3
</code></pre>
<p>All other different flags for querying resources you can check using
included into the tool help flag <code>-h</code>.</p>
<h3 id="creating-resources">Creating Resources</h3>
<h4 id="generic">Generic</h4>
<p>Generic <code>create</code> command allows you to apply provided config file into 
multiple clusters at once</p>
<pre><code class="language-shell">/repctl create -f &lt;path-to-file&gt;
</code></pre>
<h4 id="persistentvolumeclaims">PersistentVolumeClaims</h4>
<p>You can use <code>repctl</code> to create PVCs from Replication Group&rsquo;s PVs 
on the target cluster</p>
<pre><code class="language-shell">./repctl create pvc --rg &lt;rg-name&gt; -t &lt;target-namespace&gt; --dry-run=false
</code></pre>
<blockquote>
<p>By default, &lsquo;create pvc&rsquo; will do a &lsquo;dry-run&rsquo; while creating PVCs.
If you don&rsquo;t encounter any issues in the dry-run, then you can
re-run the command by turning off the dry-run flag to false.</p>
</blockquote>
<h4 id="storage-classes">Storage Classes</h4>
<p><code>repctl</code> can create special <code>replication enabled</code> storage classes from
provided config, you can find example configs in <code>examples</code> folder</p>
<pre><code class="language-shell">./repctl create sc --from-config &lt;config-file&gt;`
</code></pre>
<h3 id="single-cluster-replication">Single Cluster Replication</h3>
<p><code>repctl</code> supports working with replication within a single Kubernetes cluster.</p>
<p>Just add cluster you want to use with <code>cluster add</code> command, and you can list, filter, and create resources.</p>
<p>Volumes and ReplicationGroups created as &ldquo;target&rdquo; resources would be prefixed with <code>replicated-</code> 
so you can easily differentiate them.</p>
<p>You can also differentiate between single cluster replication configured StorageClasses and ReplicationGroups and multi-cluster ones 
by checking <code>remoteClusterID</code> field, for a single cluster the field would be set to <code>self</code>.</p>
<p>To create replication enabled storage classes for single cluster replication using <code>create sc</code> command
be sure to set both <code>sourceClusterID</code> and <code>targetClusterID</code> to the same <code>clusterID</code> and continue as usual with executing the command.
Name of StorageClass resource that created as &ldquo;target&rdquo; will be appended with <code>-tgt</code>.</p>
<h3 id="executing-actions">Executing Actions</h3>
<p><code>repctl</code> can be used to execute various replication actions on ReplicationGroups.</p>
<h4 id="failover">Failover</h4>
<p>This command will perform a planned <code>failover</code> to a cluster or an RG.</p>
<p>When working with multiple clusters, you can perform failover by specifying the target <em>cluster ID</em>. To do that use <code>--target &lt;targetClusterID&gt;</code> parameter.</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; failover --target &lt;tgt-cluster-id&gt;
</code></pre>
<p>When working with replication within a single cluster, you can perform failover by specifying the target <em>replication group ID</em>. To do that use <code>--target &lt;rg-id&gt;</code> parameter.</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; failover --target &lt;tgt-rg-id&gt;
</code></pre>
<p>In both scenarios <code>repctl</code> will patch the CR at the source site with action <strong>FAILOVER_REMOTE</strong>.</p>
<p>You can also provide <code>--unplanned</code> parameter, then <code>repctl</code> will perform an unplanned failover to a given cluster or an RG, instead of <strong>FAILOVER_REMOTE</strong> <code>repctl</code> will patch CR at target cluster with action <strong>UNPLANNED_FAILOVER_LOCAL</strong>.</p>
<h4 id="reprotect">Reprotect</h4>
<p>This command will perform a <code>reprotect</code> at the specified cluster or the RG.</p>
<p>When working with multiple clusters, you can perform reprotect by specifying the <em>cluster ID</em>. To do that use <code>--at &lt;clusterID&gt;</code> parameter.</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; reprotect --at &lt;tgt-cluster-id&gt;
</code></pre>
<p>When working with replication within a single cluster, you can perform reprotect by specifying the <em>replication group ID</em>. To do that use <code>--rg &lt;rg-id&gt;</code> parameter.</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; reprotect 
</code></pre>
<p>In both scenarios <code>repctl</code> will patch the CR at the source site with action <strong>REPROTECT_LOCAL</strong>.</p>
<h4 id="failback">Failback</h4>
<p>This command will perform a planned <code>failback</code> to a cluster or an RG.</p>
<p>When working with multiple clusters, you can perform failback by specifying the <em>cluster ID</em>, to do that use <code>--target &lt;clusterID&gt;</code> parameter.</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; failback --target &lt;tgt-cluster-id&gt;
</code></pre>
<p>When working with replication within a single cluster, you can perform failback by specifying the <em>replication group ID</em>. To do that use <code>--target &lt;rg-id&gt;</code> parameter.</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; failback --target &lt;tgt-rg-id&gt;
</code></pre>
<p>In both scenarios <code>repctl</code> will patch the CR at the source site with action <strong>FAILBACK_LOCAL</strong>.</p>
<p>You can also provide <code>--discard</code> parameter, then <code>repctl</code> will perform a failback but discard any writes at target, instead of <strong>FAILBACK_LOCAL</strong> <code>repctl</code> will patch CR at target cluster with action <strong>ACTION_FAILBACK_DISCARD_CHANGES_LOCAL</strong>.</p>
<h4 id="swap">Swap</h4>
<p>This command will perform a <code>swap</code> at a specified cluster or an RG.</p>
<p>When working with multiple clusters, you can perform swap by specifying the <em>cluster ID</em>. To do that use <code>--at &lt;clusterID&gt;</code> parameter.</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; swap --at &lt;tgt-cluster-id&gt;
</code></pre>
<p>When working with replication within a single cluster, you can perform swap by specifying the <em>replication group ID</em>. To do that use <code>--rg &lt;rg-id&gt;</code> parameter.</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; swap
</code></pre>
<p>repctl will patch CR at the source cluster with action <code>SWAP_LOCAL</code>.</p>
<h4 id="wait-for-completion">Wait For Completion</h4>
<p>When executing actions you can provide <code>--wait</code> argument to make <code>repctl</code> wait for completion of specified action.</p>
<p>For example when executing <code>failover</code>:</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; failover --target &lt;tgt-cluster-id&gt; --wait
</code></pre>
<h4 id="maintenance-actions">Maintenance Actions</h4>
<p>You can also use <code>exec</code> command to execute maintenance actions such as <code>suspend</code>, <code>resume</code>, and <code>sync</code>.</p>
<p>For single or multi-cluster config:</p>
<pre><code class="language-shell">./repctl --rg &lt;rg-id&gt; exec -a &lt;ACTION&gt;
</code></pre>
<p>Where <code>&lt;ACTION&gt;</code> can be one of the following:</p>
<ul>
<li><code>suspend</code> will suspend replication, changes will no longer be synced between replication sites</li>
<li><code>resume</code> will resume replication, canceling the effect of <code>suspend</code> action</li>
<li><code>sync</code> will force synchronization of change between replication sites</li>
</ul>



      </main>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/dell/csm" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="http://del.ly/Slack_request" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 The Dell Technologies All Rights Reserved</small>
        <small class="ml-1"><a href="https://www.dell.com/learn/us/en/uscorp1/policies-privacy" target="_blank" rel="noopener">Privacy Policy</a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>




















<script src="/csm-docs/js/main.min.9f90c5deff5c6f69d5eaaf614a76a233d8b0b3ae70b942fc78919b6d08041034.js" integrity="sha256-n5DF3v9cb2nV6q9hSnaiM9iws65wuUL8eJGbbQgEEDQ=" crossorigin="anonymous"></script>



<script src='/js/prism.js'></script>



  </body>
</html>